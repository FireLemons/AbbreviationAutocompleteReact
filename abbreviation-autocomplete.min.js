"use strict";function countingSortInsert(e,t,s,r){if(!(e instanceof Array))throw new TypeError('1st param "arr" must be an array');if(!(t instanceof Array))throw new TypeError('1st param "arrReduced" must be an array');for(let e=r+1;e<t.length;e++){const s=t[e];s&&(s[0]++,s[1]++)}const n=t[r];if(n)n[1]++;else{for(var a=r-1;a>=0;a--){const e=t[a];if(e){const s=e[1]+1;t[r]=[s,s];break}}a<0&&(t[r]=[0,0])}e.splice(t[r][1],0,s)}class AbbreviationAutocomplete extends React.Component{constructor(e){if(super(e),!e.data)throw new Error("Missing required prop data");if(!(e.data instanceof Array))throw new TypeError("Prop data must be an array. Instead received "+typeof e.data);if(isNaN(e.limit))throw new TypeError("Prop limit must be a number. Instead received "+typeof e.limit);if(isNaN(e.minSearchTextLength))throw new TypeError("Prop minSearchTextLength must be a number. Instead received "+typeof e.minSearchTextLength);if(e.placeholder&&"string"!=typeof e.placeholder)throw new TypeError("Prop placeholder must be a string. Instead received "+typeof e.placeholder);if("string"!=typeof e.searchText)throw new TypeError("Prop searchText must be a string. Instead received "+typeof e.searchText);if(e.onSelect&&!(e.onSelect instanceof Function))throw new TypeError("Prop onSelect must be a function. Instead received "+typeof e.onSelect);if(e.onSearchTextChange&&!(e.onSearchTextChange instanceof Function))throw new TypeError("Prop onSearchTextChange must be a function. Instead received "+typeof e.onSearchTextChange);this.state={data:e.data,recentlySelected:!1,showSearchItems:!1,searchList:[],searchText:void 0===e.searchText?"":e.searchText,selected:-1},this.onSearchTextChange=this.onSearchTextChange.bind(this),this.onInputFocus=this.onInputFocus.bind(this),this.onInputKeyPress=this.onInputKeyPress.bind(this),this.select=this.select.bind(this)}componentDidMount(){const e=this.props;if(e.onSelect){let t=this.select;this.select=()=>{e.onSelect(t())}}if(e.onSearchTextChange){let t=this.onSearchTextChange;this.onSearchTextChange=s=>{t(s),e.onSearchTextChange(s.target.value)}}}onInputFocus(){const e=this.state;e.recentlySelected&&this.onSearchTextChange({target:{value:e.searchText}}),this.setState({showSearchItems:!0})}onInputKeyPress(e){const t=this.state;switch(e.key){case"ArrowDown":this.setState({selected:(t.selected+1)%t.searchList.length});break;case"ArrowUp":const s=t.searchList.length;this.setState({selected:-1===t.selected?s-1:(t.selected+s-1)%s});break;case"Enter":this.select(),e.target.blur()}}onSearchTextChange(e){const t=e.target.value;if(this.props.minSearchTextLength<=t.length){const e=[],s=[];this.state.data.forEach((r=>{const n=r.d.toLowerCase().indexOf(t.toLowerCase());n>=0&&(countingSortInsert(s,e,r,n),r.substrIndex=n)})),this.setState({recentlySelected:!1,searchList:s.length<=this.props.limit?s:s.slice(0,this.props.limit),searchText:t})}else this.setState({recentlySelected:!1,searchList:[],searchText:t})}select(){const e=this.state;if(-1!==e.selected){let t=e.searchList[e.selected];delete t.substrIndex;let s=JSON.parse(JSON.stringify(t));return this.setState({recentlySelected:!0,searchText:e.searchList[e.selected].a,selected:-1,showSearchItems:!1}),s}}render(){const e=this.state;return React.createElement("div",{className:"abbreviation-autocomplete"},React.createElement("input",{type:"text",placeholder:this.props.placeholder,value:e.searchText,onBlur:()=>{this.setState({showSearchItems:!1})},onChange:this.onSearchTextChange,onFocus:this.onInputFocus,onKeyDown:this.onInputKeyPress}),React.createElement("ul",{style:{display:e.showSearchItems?null:"none"}},e.searchList.map(((t,s)=>React.createElement("li",{key:s,className:e.selected===s?"selected":null,onMouseDown:this.select,onMouseEnter:()=>{this.setState({selected:s})}},React.createElement("span",null,t.a),React.createElement("span",null," (",t.d.substr(0,t.substrIndex)),React.createElement("span",{className:"highlight"},t.d.substr(t.substrIndex,e.searchText.length)),React.createElement("span",null,t.d.substr(t.substrIndex+e.searchText.length),")"))))))}}AbbreviationAutocomplete.defaultProps={limit:1/0,minSearchTextLength:1,searchText:""};
